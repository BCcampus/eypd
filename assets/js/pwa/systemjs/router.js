System.register([],function(a){'use strict';return{setters:[],execute:function(){function b(a){return new Promise((b)=>{a.addEventListener('transitionend',function c(){a.removeEventListener('transitionend',c),b()})})}function c(){return new Promise((a)=>requestAnimationFrame(a))}function d(a,b='timeout'){return new Promise((c)=>setTimeout(()=>c(b),a))}performance.mark=performance.mark||(()=>{});class e{constructor(){this._bindHandlers(),this._hostname=location.host,document.addEventListener('click',this._onLinkClick),performance.mark('router.hijack'),window.addEventListener('popstate',this._onPopState),this._globalSpinner=importPolyfill(`${_wordpressConfig.templateUrl}/dist/scripts/pwa/pwp-spinner.js`).then((a)=>a.globalSpinner),this._transitionAnimator=importPolyfill(`${_wordpressConfig.templateUrl}/dist/scripts/pwa/transition-animator.js`).then((a)=>a.default)}_bindHandlers(){this._onLinkClick=this._onLinkClick.bind(this),this._onPopState=this._onPopState.bind(this)}_onPopState(a){this.navigate(location.href,a.state.scrollTop,!1)}async _onLinkClick(a){if('A'===a.target.tagName){const b=new URL(a.target.href);return b.host===this._hostname?b.pathname.startsWith('/wp-admin')?void(document.location.href=b):void(a.preventDefault(),this.navigate(b.toString()).catch((a)=>console.error(a.stack))):void 0}}static get TRANSITION_DURATION(){return'0.3s'}async _animateOut(a){return a.style.transition=`opacity ${e.TRANSITION_DURATION} linear`,a.style.opacity='0',b(a)}async _animateIn(a){a.style.opacity='0',await c(),await c(),a.style.transition=`opacity ${e.TRANSITION_DURATION} linear`,a.style.opacity='1',await b(a)}_loadFragment(a){const b=document.createElement('pwp-view');return b.fragmentURL=a,b}async _animateHeader(a){const b=document.querySelector('header.hero').classList.contains('single');if(b===a)return()=>{};const c=await this._transitionAnimator;return a?c.toSingle():c.toFull()}async navigate(a,b=0,c=!0){history.scrollRestoration='manual',c&&(history.replaceState({scrollTop:document.scrollingElement.scrollTop},''),history.pushState({scrollTop:b},'',a));const e=a!==_wordpressConfig.baseUrl,f=document.querySelector('pwp-view'),g=this._animateOut(f),h=this._animateHeader(e),i=this._loadFragment(a),j=(await Promise.all([g,h]))[1],k=await this._globalSpinner;'timeout'===(await Promise.race([i.ready,d(500)]))&&k.ready.then(()=>{k.show()}),await i.ready,k.ready.then(()=>k.hide()),f.parentNode.replaceChild(i,f),document.scrollingElement.scrollTop=b,history.scrollRestoration='auto',await Promise.all([this._animateIn(i),j()]),_pubsubhub.dispatch('navigation',{address:a})}}const f=new e;a('Router',e),a('instance',f)}}});