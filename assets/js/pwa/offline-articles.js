_pubsubhub.subscribe('navigation',()=>updateLinks()),window.addEventListener('offline',()=>goOffline()),window.addEventListener('online',()=>goOnline()),navigator.onLine?goOnline():goOffline();function hasCacheAPI(){return'caches'in window}function goOnline(){document.body.classList.remove('offline'),document.body.classList.add('online'),updateLinks()}function goOffline(){document.body.classList.add('offline'),document.body.classList.remove('online'),updateLinks()}function updateLinks(){hasCacheAPI()&&(Array.from(document.querySelectorAll('article.preview')).forEach((a)=>{const b=new URL(a.querySelector('a.headline').href);b.searchParams.set('fragment','true'),caches.match(b.toString()).then((b)=>{const c=!!b;a.classList.toggle('cached',c),c&&(a.querySelector('.download').innerText='Available for offline reading')})}),Array.from(document.querySelectorAll('.download')).forEach((a)=>{a.addEventListener('click',(a)=>{let b=a.target;for(;b&&'ARTICLE'!==b.nodeName;)b=b.parentNode;if(!b)throw new Error('Invalid download button?!');b.classList.contains('cached')||downloadArticle(b)})}))}async function downloadArticle(a){a.classList.add('downloading');const b=new URL(a.querySelector('header a').href);b.searchParams.append('loadimages','true');const c=document.createElement('iframe');c.src=b.toString(),c.style.display='none',document.body.appendChild(c),await new Promise((a)=>{c.addEventListener('load',()=>{setTimeout(a,2e3)})}),document.body.removeChild(c),a.classList.remove('downloading'),a.classList.add('cached')}hasCacheAPI()||document.body.classList.add('nocache');